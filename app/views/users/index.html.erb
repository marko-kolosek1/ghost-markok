<h1>Team</h1>

<% if current_user.role == "admin" %>
  <%= link_to "Invite User", new_user_invitation_path, class: "btn btn-primary" %>
  <%= link_to "General settings", settings_path, class: "btn btn-primary" %>
<% end %>

<% if current_user %>
  <%= link_to "Sign out", destroy_user_session_path, method: :delete, class: "btn btn-secondary" %>
<% else %>
  <p>You're not signed in.</p>
  <%= link_to "Sign up!", new_user_registration_path, class: "btn btn-secondary" %>
  <br>
  <%= link_to "Login", new_user_session_path, class: "btn btn-secondary" %>
<% end %>

<br>

<% @users.each do |u| %>
  <% unless u.deleted? %>
    <%= "#{u.first_name} #{u.last_name}" %>
    <%= u.decorate.avatar %>  
    <%= u.email %>
    <%= u.role %>
    <%= u.invitation_accepted? %>
    <%= link_to "Your Profile", user_path(u.id), class: "btn btn-primary" %>
    <%= u.last_seen_at %>
    <%= link_to "Stories", user_stories_path(u.id), class: "btn btn-primary" %>    
    <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#deleteModal<%u.id%>">
      Delete user
    </button>

    <!-- Modal -->
    <div class="modal fade" id="deleteModal<% u.id %>" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p>Are you sure you want to remove <%= "#{u.first_name} #{u.last_name}" %></p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
              <%= link_to "Yes", user_path(u), method: :delete, class: "btn btn-danger" %>
          </div>
        </div>
      </div>
    </div>    
  <% end %>
  <br>
  <br>
<% end %>

<%= paginate @users %>
